(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{296:function(e,t,a){e.exports=a(485)},301:function(e,t,a){},302:function(e,t,a){},485:function(e,t,a){"use strict";a.r(t);var n=a(69),r=a.n(n);a(301),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(0),o=a.n(l),c=a(39),i=a(22),u=(a(302),a(21)),s=a(24),m=a(255),g=a.n(m),d={user:null,navItem:"home"},v="/"===window.location.pathname?"home":"login";if(d.navItem=v,localStorage.getItem("jwtToken")){var p=g()(localStorage.getItem("jwtToken"));1e3*p.exp<Date.now()?localStorage.removeItem("jwtToken"):d.user=p}var E=Object(l.createContext)({user:null,navItem:"home",login:function(e){},logout:function(){}});function b(e,t){switch(t.type){case"LOGIN":return Object(s.a)(Object(s.a)({},e),{},{user:t.payload});case"LOGOUT":return Object(s.a)(Object(s.a)({},e),{},{user:null});case"NAV":return Object(s.a)(Object(s.a)({},e),{},{navItem:t.payload});default:return e}}function h(e){var t=Object(l.useReducer)(b,d),a=Object(u.a)(t,2),n=a[0],r=a[1];return o.a.createElement(E.Provider,Object.assign({value:{user:n.user,navItem:n.navItem,setHome:function(){r({type:"NAV",payload:"home"})},setLogin:function(){r({type:"NAV",payload:"login"})},login:function(e){localStorage.setItem("jwtToken",e.token),r({type:"LOGIN",payload:e})},logout:function(){localStorage.removeItem("jwtToken"),r({type:"LOGOUT"})}}},e))}var f=a(285),j=a(88),I=a(138),k=a(510),O=a(287);var y=function(){var e=Object(l.useState)(!1),t=Object(u.a)(e,2),a=t[0],n=t[1],r=Object(l.useContext)(E),s=Object(i.e)(),m=function(){n(!a)};return r.user?o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a,{color:"blue"},o.a.createElement(f.a.Item,null,o.a.createElement("h1",null,o.a.createElement("a",{href:"/"},"eB"))),o.a.createElement(f.a.Item,{name:"home",active:"home"===r.navItem,as:c.b,to:"/",onClick:r.setHome,position:"right"},o.a.createElement(j.a,{name:"home"}),"Home"),o.a.createElement(f.a.Item,{name:"logout",onClick:m},o.a.createElement(j.a,{name:"log out"}),"Log Out")),o.a.createElement(I.a,{basic:!0,size:"small",open:a},o.a.createElement(k.a,{icon:"log out",content:"Please confirm"}),o.a.createElement(I.a.Content,null,o.a.createElement("p",null,"Are you sure you want to log out?")),o.a.createElement(I.a.Actions,null,o.a.createElement(O.a,{basic:!0,color:"red",inverted:!0,onClick:m},o.a.createElement(j.a,{name:"remove"})," No"),o.a.createElement(O.a,{color:"green",inverted:!0,onClick:function(){r.logout(),m(),s.push("/login"),r.setLogin()}},o.a.createElement(j.a,{name:"checkmark"})," Yes")))):o.a.createElement(f.a,{color:"blue"},o.a.createElement(f.a.Item,null,o.a.createElement("h1",null,o.a.createElement("a",{href:"/"},"eB"))),o.a.createElement(f.a.Item,{name:"home",active:"home"===r.navItem,as:c.b,to:"/",onClick:r.setHome,position:"right"},o.a.createElement(j.a,{name:"home"}),"Home"),o.a.createElement(f.a.Item,{name:"login",active:"login"===r.navItem,as:c.b,to:"/login",onClick:r.setLogin},o.a.createElement(j.a,{name:"user"}),"Login"))},C=a(33),w=a(59),S=a(26),$=a(34),x=a.n($),P=a(499);function B(){var e=Object(C.a)(["\n  mutation deleteBooking($bookingId: String!) {\n    deleteBooking(bookingId: $bookingId) {\n      _id\n    }\n  }\n"]);return B=function(){return e},e}var L=x()(B()),N=function(e){var t=Object(l.useContext)(E),a=Object(l.useState)(!1),n=Object(u.a)(a,2),r=n[0],c=n[1],i=e.bookingId,s=Object(S.a)(L,{variables:{bookingId:i},onError:function(e){},refetchQueries:[{query:Q},{query:A,variables:{userId:t.user?t.user.userId:null}}]}),m=Object(u.a)(s,2),g=m[0],d=m[1],v=d.loading;return d.error?o.a.createElement("h1",null,"Error..."):o.a.createElement("div",{className:"ui two buttons"},o.a.createElement(O.a,{type:"submit",color:"red",onClick:function(e){return c(!0)}},"Cancel Booking"),o.a.createElement(P.a,{className:v?"loading":"",open:r,cancelButton:"Never mind",confirmButton:"Let's do it",onCancel:function(e){return c(!1)},onConfirm:function(){g(),c(!1)}}))},_=a(507),T=a(284);function D(){var e=Object(C.a)(["\n  query userBookings($userId: String!) {\n    userBookings(userId: $userId) {\n      _id\n      event {\n        _id\n        title\n        description\n        price\n        date\n        creator {\n          avator\n        }\n      }\n    }\n  }\n"]);return D=function(){return e},e}var A=x()(D()),H=function(){var e=Object(l.useContext)(E),t=Object(S.b)(A,{variables:{userId:e.user?e.user.userId:null}}),a=t.loading,n=t.error,r=t.data;return a?"Loading...":n?"Error! ".concat(n.message):(console.log(r.userBookings),o.a.createElement("div",null,o.a.createElement(_.a.Group,{centered:!0},r.userBookings&&r.userBookings.map((function(e){return e.event&&o.a.createElement(_.a,{key:e._id},o.a.createElement(_.a.Content,null,o.a.createElement(T.a,{floated:"right",size:"mini",src:e.event&&e.event.length>0?e.event.creator.avator:null}),o.a.createElement(_.a.Header,null,o.a.createElement("strong",null,e.event.title)),o.a.createElement(_.a.Meta,null,"$",e.event.price,", ",e.event.date),o.a.createElement(_.a.Description,null,e.event.description)),o.a.createElement(_.a.Content,{extra:!0},o.a.createElement(N,{bookingId:e._id})))})))))};function q(){var e=Object(C.a)(["\n  mutation createBooking($eventId: String!, $userId: String!) {\n    createBooking(input: { eventId: $eventId, userId: $userId }) {\n      _id\n    }\n  }\n"]);return q=function(){return e},e}var F=x()(q()),M=function(e){var t=e.eventId,a=e.userId,n=e.bookings,r=Object(l.useContext)(E),c=Object(l.useState)(!1),i=Object(u.a)(c,2),s=i[0],m=i[1],g=Object(S.a)(F,{update:function(e,t){console.log(t)},variables:{eventId:t,userId:a},onError:function(e){},refetchQueries:[{query:Q},{query:A,variables:{userId:r.user?r.user.userId:null}}]}),d=Object(u.a)(g,2),v=d[0],p=d[1],b=p.loading;return p.error?o.a.createElement("p",null,"Error..."):n&&n.length>0&&n.filter((function(e){return e.userId===a})).length>0?o.a.createElement(o.a.Fragment,null,o.a.createElement(O.a,{color:"green",floated:"right"},"Booked")):o.a.createElement(o.a.Fragment,null,o.a.createElement(O.a,{primary:!0,floated:"right",onClick:function(e){return m(!0)}},"Book",o.a.createElement(j.a,{name:"right chevron"})),o.a.createElement(P.a,{open:s,onCancel:function(e){return m(!1)},onConfirm:function(){v(),m(!1)},className:b?"loading":""}))},G=a(504);function U(){var e=Object(C.a)(["\n  query {\n    events {\n      _id\n      title\n      description\n      price\n      date\n      creatorId\n      creator {\n        username\n        avator\n      }\n      bookings {\n        userId\n      }\n    }\n  }\n"]);return U=function(){return e},e}var J=function(){var e=Object(l.useContext)(E),t=Object(S.b)(Q),a=t.loading,n=t.error,r=t.data;return a?"Loading...":n?"Error! ".concat(n.message):o.a.createElement("div",null,o.a.createElement(G.a.Group,{divided:!0},r.events&&r.events.map((function(t){return o.a.createElement(G.a,{key:t._id},o.a.createElement(G.a.Image,{src:t.creator.avator}),o.a.createElement(G.a.Content,null,o.a.createElement(G.a.Header,null,t.title),o.a.createElement(G.a.Meta,null,o.a.createElement("span",{className:"price"},"$",t.price,",")," ",o.a.createElement("span",{className:"date"},t.date)),o.a.createElement(G.a.Description,null,t.description),o.a.createElement(G.a.Extra,null,e.user?e.user.userId===t.creatorId?null:o.a.createElement(M,{eventId:t._id,userId:e.user?e.user.userId:null,bookings:t.bookings}):o.a.createElement(O.a,{as:c.b,to:"/login",primary:!0,floated:"right",onClick:e.setLogin},"Book",o.a.createElement(j.a,{name:"right chevron"})))))}))))},Q=x()(U());function z(){var e=Object(C.a)(["\n  mutation deleteEvent($_id: String!, $creatorId: String!) {\n    deleteEvent(input: { _id: $_id, creatorId: $creatorId }) {\n      _id\n    }\n  }\n"]);return z=function(){return e},e}var V=x()(z()),R=function(e){var t=Object(l.useState)(!1),a=Object(u.a)(t,2),n=a[0],r=a[1],c=e.eventId,i=e.creatorId,s=Object(S.a)(V,{variables:{_id:c,creatorId:i},onError:function(e){},refetchQueries:[{query:Q}]}),m=Object(u.a)(s,2),g=m[0],d=m[1],v=d.loading;return d.error?o.a.createElement("h1",null,"Error..."):o.a.createElement("div",{className:"ui two buttons"},o.a.createElement(O.a,{type:"submit",color:"red",onClick:function(e){return r(!0)}},"Delete"),o.a.createElement(P.a,{className:v?"loading":"",open:n,cancelButton:"Never mind",confirmButton:"Let's do it",onCancel:function(e){return r(!1)},onConfirm:function(){g(),r(!1)}}))};var W=function(){var e=Object(l.useContext)(E),t=Object(S.b)(Q),a=t.loading,n=t.error,r=t.data;if(a)return o.a.createElement("h1",null,"Loading...");if(n)return o.a.createElement("h1",null,"Error...");var c=r.events.filter((function(t){return t.creatorId===e.user.userId}));return o.a.createElement("div",null,o.a.createElement(_.a.Group,{centered:!0},c&&c.map((function(t){return o.a.createElement(_.a,{key:t._id},o.a.createElement(_.a.Content,null,o.a.createElement(_.a.Header,null,o.a.createElement("strong",null,t.title)),o.a.createElement(_.a.Meta,null,"$",t.price,", ",t.date),o.a.createElement(_.a.Description,null,t.description)),o.a.createElement(_.a.Content,{extra:!0},o.a.createElement(R,{eventId:t._id,creatorId:e.user?e.user.userId:null})))}))))},Y=a(505),K=a(512),X=a(502);function Z(){var e=Object(C.a)(["\n  mutation createEvent(\n    $creatorId: String!\n    $title: String!\n    $description: String!\n    $price: Float!\n    $date: String!\n  ) {\n    createEvent(\n      input: {\n        creatorId: $creatorId\n        title: $title\n        description: $description\n        price: $price\n        date: $date\n      }\n    ) {\n      _id\n      title\n      description\n      price\n      date\n      creatorId\n    }\n  }\n"]);return Z=function(){return e},e}var ee=x()(Z()),te=function(){var e=Object(l.useState)({title:"",description:"",price:"",date:""}),t=Object(u.a)(e,2),a=t[0],n=t[1],r=Object(l.useState)(!1),i=Object(u.a)(r,2),m=i[0],g=i[1],d=Object(l.useContext)(E),v=function(){g(!1)},p=function(e){n(Object(s.a)(Object(s.a)({},a),{},Object(w.a)({},e.target.name,e.target.value)))},b=Object(S.a)(ee,{update:function(e,t){},variables:Object(s.a)(Object(s.a)({},a),{},{creatorId:d.user?d.user.userId:null,price:parseFloat(a.price)}),onError:function(e){},refetchQueries:[{query:Q}]}),h=Object(u.a)(b,2),j=h[0],y=h[1],C=y.loading,$=y.error,x=[{menuItem:o.a.createElement(f.a.Item,{key:"all-events"},"All Events",o.a.createElement("hr",{style:{visibility:"hidden"}}),o.a.createElement(Y.a,{content:"Add an event",trigger:o.a.createElement(O.a,{icon:"plus",circular:!0,onClick:function(){g(!0)}}),position:"right center"})),render:function(){return o.a.createElement(K.a.Pane,null,o.a.createElement(J,null))}},d.user&&{menuItem:o.a.createElement(f.a.Item,{key:"created-events"},"Created Events"),render:function(){return o.a.createElement(K.a.Pane,null,o.a.createElement(W,null))}},d.user&&{menuItem:o.a.createElement(f.a.Item,{key:"bookings"},"Bookings"),render:function(){return o.a.createElement(K.a.Pane,null,o.a.createElement(H,null))}}],P=o.a.createElement(o.a.Fragment,null," ",o.a.createElement(I.a.Header,null,"Please Login or Signup to add a new event."),o.a.createElement(I.a.Content,null,o.a.createElement(I.a.Actions,null,o.a.createElement(O.a,{as:c.b,to:"/login",positive:!0,icon:"user",labelPosition:"right",content:"Login",onClick:d.setLogin}),o.a.createElement(O.a,{as:c.b,to:"/login",positive:!0,icon:"signup",labelPosition:"right",content:"Signup",onClick:d.setLogin})))),B=o.a.createElement(o.a.Fragment,null,o.a.createElement(I.a.Header,null,"Add an event"),o.a.createElement(I.a.Content,null,o.a.createElement(I.a.Description,null,o.a.createElement(k.a,null,"Enter below details"),o.a.createElement(X.a,{onSubmit:function(e){e.preventDefault(),j(),n({title:"",description:"",price:"",date:""}),g(!1)},className:C?"loading":""},o.a.createElement(X.a.Input,{icon:"star",iconPosition:"right",label:"Title",placeholder:"Name of the event..",name:"title",value:a.title,onChange:p}),o.a.createElement(X.a.TextArea,{label:"Description",placeholder:"Tell us about the event..",name:"description",value:a.description,onChange:p}),o.a.createElement(X.a.Input,{icon:"dollar sign",iconPosition:"right",label:"Price",placeholder:"How much does it cost..",name:"price",value:a.price,onChange:p}),o.a.createElement(X.a.Input,{label:"Date",placeholder:"When is it..",name:"date",type:"date",value:a.date,onChange:p}),o.a.createElement(O.a,{floated:"right",color:"red",icon:"cancel",labelPosition:"right",content:"No, I changed my mind!",onClick:v}),o.a.createElement(O.a,{positive:!0,icon:"checkmark",labelPosition:"right",content:"Yep, add it!"})))));return $&&console.log($),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{marginTop:"10px"}},o.a.createElement(K.a,{menu:{fluid:!0,vertical:!0,tabular:"right"},panes:x})),o.a.createElement(I.a,{dimmer:"blurring",open:m,closeOnEscape:m,closeOnDimmerClick:m,onClose:v,size:"tiny"},d.user?B:P))},ae=a(506);function ne(){var e=Object(C.a)(["\n  mutation registerUser(\n    $username: String!\n    $email: String!\n    $password: String!\n    $avator: String!\n  ) {\n    registerUser(\n      input: {\n        username: $username\n        email: $email\n        password: $password\n        avator: $avator\n      }\n    ) {\n      userId\n      token\n      tokenExp\n    }\n  }\n"]);return ne=function(){return e},e}var re=x()(ne()),le=function(){var e=Object(l.useContext)(E),t=Object(i.e)(),a=Object(l.useState)({username:"",email:"",password:"",avator:""}),n=Object(u.a)(a,2),r=n[0],c=n[1],m=Object(S.a)(re,{update:function(a,n){e.login(n.data.registerUser),t.push("/"),e.setHome()},variables:r,onError:function(e){}}),g=Object(u.a)(m,2),d=g[0],v=g[1],p=v.loading,b=v.error,h=function(e){c(Object(s.a)(Object(s.a)({},r),{},Object(w.a)({},e.target.name,e.target.value)))};return o.a.createElement("div",null,o.a.createElement("h1",null,"Register"),o.a.createElement("hr",{style:{visibility:"hidden"}}),o.a.createElement(X.a,{onSubmit:function(e){e.preventDefault(),d()},className:p?"loading":""},o.a.createElement(X.a.Input,{icon:"user",iconPosition:"left",label:"Username",placeholder:"Username..",name:"username",value:r.username,onChange:h}),o.a.createElement(X.a.Input,{icon:"mail",iconPosition:"left",label:"Email",placeholder:"Email..",name:"email",value:r.email,onChange:h}),o.a.createElement(X.a.Input,{icon:"lock",iconPosition:"left",label:"Password",type:"password",placeholder:"Password..",name:"password",value:r.password,onChange:h}),o.a.createElement("hr",{style:{visibility:"hidden"}}),o.a.createElement(ae.a,{placeholder:"Choose an avator",selection:!0,options:[{key:"Jenny",text:"Jenny",value:"https://react.semantic-ui.com/images/avatar/large/jenny.jpg",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/jenny.jpg"}},{key:"Elliot",text:"Elliot",value:"https://react.semantic-ui.com/images/avatar/large/elliot.jpg",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/elliot.jpg"}},{key:"Stevie",text:"Stevie",value:"https://react.semantic-ui.com/images/avatar/large/stevie.jpg",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/stevie.jpg"}},{key:"Christian",text:"Christian",value:"https://react.semantic-ui.com/images/avatar/large/christian.jpg",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/christian.jpg"}},{key:"Matt",text:"Matt",value:"https://react.semantic-ui.com/images/avatar/large/matt.jpg",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/matt.jpg"}},{key:"Justen",text:"Justen",value:"https://react.semantic-ui.com/images/avatar/large/justen.jpg",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/justen.jpg"}},{key:"Daniel",text:"Daniel",value:"https://react.semantic-ui.com/images/avatar/large/daniel.jpg",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/daniel.jpg"}},{key:"Tom",text:"Tom",value:"https://react.semantic-ui.com/images/avatar/large/tom.jpg",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/tom.jpg"}},{key:"Rachel",text:"Rachel",value:"https://react.semantic-ui.com/images/avatar/large/rachel.png",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/rachel.png"}},{key:"Veronika",text:"Veronika",value:"https://react.semantic-ui.com/images/avatar/large/veronika.jpg",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/veronika.jpg"}},{key:"Matthew",text:"Matthew",value:"https://react.semantic-ui.com/images/avatar/large/matthew.png",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/matthew.png"}},{key:"Molly",text:"Molly",value:"https://react.semantic-ui.com/images/avatar/large/molly.png",image:{avatar:!0,src:"https://react.semantic-ui.com/images/avatar/large/molly.png"}}],name:"avator",value:r.avator,onChange:function(e,t){var a=t.value;c(Object(s.a)(Object(s.a)({},r),{},{avator:a}))}}),o.a.createElement("hr",{style:{visibility:"hidden"}}),o.a.createElement(O.a,{content:"Sign up",primary:!0})),o.a.createElement("div",{className:b?"ui error message":""},b&&b.graphQLErrors[0].message,o.a.createElement("br",null),o.a.createElement("br",null),b&&o.a.createElement("span",null,"Please try again")))},oe=a(500),ce=a(179),ie=a(286),ue=a(501);function se(){var e=Object(C.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(input: { email: $email, password: $password }) {\n      userId\n      token\n      tokenExp\n    }\n  }\n"]);return se=function(){return e},e}var me=x()(se()),ge=function(){var e=Object(l.useContext)(E),t=Object(i.e)(),a=Object(l.useState)({email:"",password:""}),n=Object(u.a)(a,2),r=n[0],c=n[1],m=Object(l.useState)(!1),g=Object(u.a)(m,2),d=g[0],v=g[1],p=Object(S.a)(me,{update:function(a,n){e.login(n.data.login),t.push("/"),e.setHome()},variables:r,onError:function(e){}}),b=Object(u.a)(p,2),h=b[0],f=b[1],j=f.loading,I=f.error,k=function(e){c(Object(s.a)(Object(s.a)({},r),{},Object(w.a)({},e.target.name,e.target.value)))};return o.a.createElement(oe.a,null,o.a.createElement(ce.a,{style:{marginTop:"50px"},placeholder:!0,padded:"very",fluid:"true"},o.a.createElement(ie.a,{columns:2,relaxed:"very",stackable:!0},o.a.createElement(ie.a.Column,{verticalAlign:"middle"},o.a.createElement("h1",null,"Login"),o.a.createElement("hr",{style:{visibility:"hidden"}}),o.a.createElement(X.a,{onSubmit:function(e){e.preventDefault(),h()},className:j?"loading":""},o.a.createElement(X.a.Input,{icon:"mail",iconPosition:"left",label:"Email",placeholder:"Email..",name:"email",value:r.email,onChange:k}),o.a.createElement(X.a.Input,{icon:"lock",iconPosition:"left",label:"Password",type:"password",placeholder:"Password..",name:"password",value:r.password,onChange:k}),o.a.createElement(O.a,{content:"Login",primary:!0})),o.a.createElement("div",{className:I?"ui error message":""},I&&I.graphQLErrors[0].message,o.a.createElement("br",null),o.a.createElement("br",null),I&&o.a.createElement("span",null,"Please try again"))),o.a.createElement(ie.a.Column,{verticalAlign:"middle"},!d&&o.a.createElement(O.a,{content:"Sign up",icon:"signup",size:"big",onClick:function(e){v(!0)}}),d&&o.a.createElement(le,null))),o.a.createElement(ue.a,{vertical:!0},"Or")))};a(484);var de=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(oe.a,null,o.a.createElement(h,null,o.a.createElement(c.a,null,o.a.createElement(y,null),o.a.createElement("div",{className:"App"},o.a.createElement(i.a,{exact:!0,path:"/",component:te}),o.a.createElement(i.a,{exact:!0,path:"/login",component:ge}))))))},ve=a(509),pe=a(50),Ee=a(89),be=a(508),he=a(35),fe=new ve.a({uri:"https://events-bookings-app-server.herokuapp.com/graphql/"}),je=new pe.a((function(e,t){var a=localStorage.getItem("jwtToken");return e.setContext({headers:{authorization:a?"Bearer ".concat(a):""}}),t(e)})),Ie=new Ee.a({link:je.concat(fe),cache:new be.a}),ke=o.a.createElement(he.a,{client:Ie},o.a.createElement(de,null));r.a.render(ke,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[296,1,2]]]);
//# sourceMappingURL=main.f1d71416.chunk.js.map